{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kripton/Desktop/js/hexlet-chat/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/kripton/Desktop/js/hexlet-chat/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/kripton/Desktop/js/hexlet-chat/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{Formik,Form,ErrorMessage,Field}from'formik';import*as Yup from'yup';import{useNavigate}from'react-router-dom';import{useState}from'react';import{useAuth}from'./auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginForm=function LoginForm(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUser=_useState2[1];var auth=useAuth();console.log(auth);var navigate=useNavigate();var initialValues={username:username,password:''};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values,formikBag){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(values);axios.post('/api/v1/login',{username:values.username,password:values.password}).then(function(response){var _response$data=response.data,token=_response$data.token,username=_response$data.username;console.log(response.data);localStorage.setItem('token','Bearer '+token);axios.defaults.headers.common['Authorization']='Bearer '+token;setUser(username);auth.login(username);navigate('/');}).catch(function(error){// console.log(formikBag);\nformikBag.setStatus(true);values.error=error.response.data.error;});case 2:case\"end\":return _context.stop();}},_callee);}));return function onSubmit(_x,_x2){return _ref.apply(this,arguments);};}();var validationSchema=Yup.object({username:Yup.string().required('Required'),password:Yup.string().required('Required')});return/*#__PURE__*/_jsx(Formik,{initialValues:initialValues,validationSchema:validationSchema,onSubmit:onSubmit,children:function children(_ref2){var status=_ref2.status;return/*#__PURE__*/_jsxs(Form,{className:\"col-12 col-md-6 mt-3 mt-mb-0\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center mb-4\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3 \",children:[/*#__PURE__*/_jsx(Field,{className:\"form-control\",name:\"username\",autocomplete:\"username\",required:\"\",placeholder:\"\\u0412\\u0430\\u0448 \\u043D\\u0438\\u043A\",id:\"username\"}),/*#__PURE__*/_jsx(ErrorMessage,{name:\"username\",children:function children(errorMsg){return/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:errorMsg});}}),/*#__PURE__*/_jsx(\"label\",{for:\"username\",children:\"\\u0412\\u0430\\u0448 \\u043D\\u0438\\u043A\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-4\",children:[/*#__PURE__*/_jsx(Field,{className:\"form-control\",name:\"password\",autocomplete:\"current-password\",required:\"\",placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",id:\"password\"}),/*#__PURE__*/_jsx(ErrorMessage,{name:\"password\",children:function children(errorMsg){return/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:errorMsg});}}),status?/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:\"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0435 \\u0438\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F \\u0438\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"}):null,/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",for:\"password\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-100 mb-3 btn btn-outline-primary\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]});}});};export default LoginForm;","map":{"version":3,"names":["axios","Formik","Form","ErrorMessage","Field","Yup","useNavigate","useState","useAuth","LoginForm","username","setUser","auth","console","log","navigate","initialValues","password","onSubmit","values","formikBag","post","then","response","data","token","localStorage","setItem","defaults","headers","common","login","catch","error","setStatus","validationSchema","object","string","required","status","errorMsg"],"sources":["/Users/kripton/Desktop/js/hexlet-chat/frontend/src/components/LoginForm.jsx"],"sourcesContent":["import axios from 'axios';\nimport { Formik, Form, ErrorMessage, Field } from 'formik';\nimport * as Yup from 'yup';\nimport { useNavigate } from 'react-router-dom';\nimport { useState } from 'react';\nimport { useAuth } from './auth';\n\n\nconst LoginForm = () => {\n    const [username, setUser] = useState(''); \n    const auth =  useAuth();\n    console.log(auth);\n    const navigate = useNavigate();\n    const initialValues = {\n        username,\n        password: '',\n    }\n    const onSubmit = async (values, formikBag) => {\n            console.log(values);\n            axios.post('/api/v1/login',{\n                username: values.username,\n                password: values.password,\n            })\n            .then( (response) => {\n                const { token, username } = response.data;\n                console.log(response.data);\n                localStorage.setItem('token', 'Bearer ' + token);\n                axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n                setUser(username);\n                auth.login(username);\n                navigate('/');\n                })\n            .catch((error) => {\n                // console.log(formikBag);\n                formikBag.setStatus(true);\n                values.error = error.response.data.error\n            })\n    }\n\n    const validationSchema = Yup.object({\n        username: Yup.string().required('Required'),\n        password: Yup.string().required('Required'),\n    })\n\n    return (\n        <Formik\n        initialValues={initialValues}\n        validationSchema={validationSchema}\n        onSubmit={onSubmit}>\n        {({status}) => (\n            <Form className=\"col-12 col-md-6 mt-3 mt-mb-0\">\n                <h1 className=\"text-center mb-4\">Войти</h1>\n                <div className=\"form-floating mb-3 \">\n                    <Field\n                        className=\"form-control\"\n                        name=\"username\"\n                        autocomplete=\"username\"\n                        required=\"\"\n                        placeholder=\"Ваш ник\"\n                        id=\"username\"\n                    />\n                    <ErrorMessage name='username'>\n                    {(errorMsg) => <div className='text-danger'>{errorMsg}</div>}\n                    </ErrorMessage>\n                    <label for=\"username\">Ваш ник</label>\n                </div>\n                <div className=\"form-floating mb-4\">\n                    <Field\n                        className=\"form-control\"\n                        name=\"password\"\n                        autocomplete=\"current-password\"\n                        required=\"\" placeholder=\"Пароль\"\n                        type=\"password\"\n                        id=\"password\"\n                    />\n                    <ErrorMessage name='password'>\n                    {(errorMsg) => <div className='text-danger'>{errorMsg}</div>}\n                    </ErrorMessage>\n                    {status ? <div className=\"text-danger\">Неверные имя пользователя или пароль</div> : null }\n                    <label className=\"form-label\" for=\"password\">Пароль</label>\n                </div>\n                <button type=\"submit\" className=\"w-100 mb-3 btn btn-outline-primary\">Войти</button>\n               \n            </Form>\n        )}\n      </Formik>\n    );\n}   \n\nexport default LoginForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}